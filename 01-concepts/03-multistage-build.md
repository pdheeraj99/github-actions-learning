# ğŸ³ 03 - Multi-Stage Build Magic Explained

## 1. Multi-Stage Build Ante Enti?

Multi-stage build lo **multiple FROM statements** use chesthaam. Oka stage build kosam, inkoka stage run kosam!

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚   Simple Telugu Explanation:                                                 â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                 â”‚
â”‚                                                                              â”‚
â”‚   Restaurant Kitchen Analogy:                                                â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚
â”‚                                                                              â”‚
â”‚   STAGE 1: KITCHEN (Preparation)                                            â”‚
â”‚   â€¢ Vegetables cut cheyyi                                                   â”‚
â”‚   â€¢ Spices grind cheyyi                                                     â”‚
â”‚   â€¢ All prep work                                                            â”‚
â”‚   â€¢ MESSY (lot of tools, waste!)                                            â”‚
â”‚                                                                              â”‚
â”‚   STAGE 2: SERVING (Final)                                                  â”‚
â”‚   â€¢ Only cooked dish ikkadiki vasthundhi                                    â”‚
â”‚   â€¢ Clean plate lo serve                                                     â”‚
â”‚   â€¢ No knives, no cutting boards!                                           â”‚
â”‚   â€¢ CLEAN (only final product!)                                             â”‚
â”‚                                                                              â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                              â”‚
â”‚   Same logic Docker lo:                                                      â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                     â”‚
â”‚   STAGE 1 (builder): Node.js, npm, node_modules, build tools               â”‚
â”‚   STAGE 2 (final): Just Nginx + built files. NO Node.js!                    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Problem: Single Stage Build (BAD Way! âŒ)

```dockerfile
# Single Stage - Everything in one image
FROM node:20-alpine
WORKDIR /app
COPY . .
RUN npm ci
RUN npm run build
CMD ["npm", "start"]
```

### 2.1 Idhi Enduku Problem?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚   SINGLE STAGE IMAGE - EEMI UNDHI LOPALA?                                   â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                    â”‚
â”‚                                                                              â”‚
â”‚   Image Contents:                                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚   node:20-alpine base                           180MB              â”‚    â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚   â”‚   node_modules/ (react, vite, 500+ packages)    500MB              â”‚    â”‚
â”‚   â”‚   â†‘ Production lo ivi AVASARAM LEDU!                               â”‚    â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚   â”‚   src/ (App.tsx, main.tsx - SOURCE CODE!)        10MB              â”‚    â”‚
â”‚   â”‚   â†‘ SECURITY RISK! Source code expose avuthundhi!                  â”‚    â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚   â”‚   dist/ (built files - IDHE KAVALI!)              2MB              â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚   TOTAL: ~700MB+ ğŸ˜±                                                          â”‚
â”‚                                                                              â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                              â”‚
â”‚   PROBLEMS:                                                                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                 â”‚
â”‚   1. Image SIZE peddadi (700MB) - slow deployments!                         â”‚
â”‚   2. Source code IMAGE lo undhi - SECURITY RISK! ğŸ”’                         â”‚
â”‚   3. node_modules IMAGE lo undhi - avasaram ledu production lo!             â”‚
â”‚   4. Node.js IMAGE lo undhi - static files ki Node.js enduku?               â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Solution: Multi-Stage Build (GOOD Way! âœ…)

```dockerfile
# ========== STAGE 1: BUILD ==========
FROM node:20-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

# ========== STAGE 2: SERVE ==========
FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

### 3.1 Diagramattho Chuddham

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚   MULTI-STAGE BUILD - TWO STAGES                                            â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                         â”‚
â”‚                                                                              â”‚
â”‚   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚   â•‘  STAGE 1: "builder" (Kitchen - messy but necessary!)                  â•‘ â”‚
â”‚   â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ â”‚
â”‚   â•‘                                                                        â•‘ â”‚
â”‚   â•‘  FROM node:20-alpine AS builder                                       â•‘ â”‚
â”‚   â•‘  â€¢ Node.js installed âœ…                                                â•‘ â”‚
â”‚   â•‘  â€¢ npm installed âœ…                                                    â•‘ â”‚
â”‚   â•‘  â€¢ Base size: 180MB                                                   â•‘ â”‚
â”‚   â•‘                                                                        â•‘ â”‚
â”‚   â•‘  After all commands:                                                  â•‘ â”‚
â”‚   â•‘  /app/                                                                 â•‘ â”‚
â”‚   â•‘  â”œâ”€â”€ node_modules/  (500MB) â† Build ki kavali                         â•‘ â”‚
â”‚   â•‘  â”œâ”€â”€ src/           (10MB)  â† Source code                             â•‘ â”‚
â”‚   â•‘  â””â”€â”€ dist/          (2MB)   â† â˜… BUILT FILES - IDHE FINAL OUTPUT! â˜…   â•‘ â”‚
â”‚   â•‘                                                                        â•‘ â”‚
â”‚   â•‘  Total: ~700MB (temporary - throw away!)                              â•‘ â”‚
â”‚   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                              â”‚                                               â”‚
â”‚                              â”‚ COPY --from=builder /app/dist                â”‚
â”‚                              â”‚ (Only dist/ folder goes to Stage 2!)         â”‚
â”‚                              â–¼                                               â”‚
â”‚   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚   â•‘  STAGE 2: "final" (Dining Table - clean, minimal!)                    â•‘ â”‚
â”‚   â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ â”‚
â”‚   â•‘                                                                        â•‘ â”‚
â”‚   â•‘  FROM nginx:alpine                                                    â•‘ â”‚
â”‚   â•‘  â€¢ Nginx installed âœ…                                                  â•‘ â”‚
â”‚   â•‘  â€¢ NO Node.js! âŒ                                                      â•‘ â”‚
â”‚   â•‘  â€¢ NO npm! âŒ                                                          â•‘ â”‚
â”‚   â•‘  â€¢ Base size: 25MB                                                    â•‘ â”‚
â”‚   â•‘                                                                        â•‘ â”‚
â”‚   â•‘  /usr/share/nginx/html/                                                â•‘ â”‚
â”‚   â•‘  â””â”€â”€ dist/ contents (2MB) â† ONLY THIS!                                â•‘ â”‚
â”‚   â•‘                                                                        â•‘ â”‚
â”‚   â•‘  Total: ~30MB only! ğŸ‰                                                 â•‘ â”‚
â”‚   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                              â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                              â”‚
â”‚   SUMMARY:                                                                   â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                  â”‚
â”‚   Stage 1 (builder): THROWN AWAY! ğŸ—‘ï¸ (700MB waste undhi - parvaledu!)      â”‚
â”‚   Stage 2 (final):   SAVED AS IMAGE! ğŸ“¦ (30MB only - perfect!)             â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. COPY --from=builder - Magic Line! âœ¨

```dockerfile
COPY --from=builder /app/dist /usr/share/nginx/html
```

### 4.1 Breakdown

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚   COPY --from=builder /app/dist /usr/share/nginx/html                       â”‚
â”‚         â”‚              â”‚                â”‚                                    â”‚
â”‚         â”‚              â”‚                â””â”€â”€ WHERE to put (Stage 2 lo)       â”‚
â”‚         â”‚              â””â”€â”€ WHAT to copy (Stage 1 lo ee folder)              â”‚
â”‚         â””â”€â”€ FROM WHERE (Previous stage name)                                â”‚
â”‚                                                                              â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                              â”‚
â”‚   Telugu Explanation:                                                        â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                       â”‚
â”‚   "Stage 1 (builder stage) lo /app/dist folder theesuko,                    â”‚
â”‚    Stage 2 lo /usr/share/nginx/html ki copy cheyyi"                         â”‚
â”‚                                                                              â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                              â”‚
â”‚   Normal COPY vs --from COPY:                                                â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                â”‚
â”‚                                                                              â”‚
â”‚   COPY ./src /app/src                                                        â”‚
â”‚   â†‘ From YOUR WINDOWS to Container                                          â”‚
â”‚                                                                              â”‚
â”‚   COPY --from=builder /app/dist ...                                         â”‚
â”‚   â†‘ From ANOTHER STAGE to Container (Stage to Stage copy!)                  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Size Comparison - Real Numbers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚   SINGLE STAGE:                         MULTI-STAGE:                         â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•                        â•â•â•â•â•â•â•â•â•â•â•â•                          â”‚
â”‚                                                                              â”‚
â”‚   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                             â”‚
â”‚   ~700MB                                 ~30MB                                â”‚
â”‚                                                                              â”‚
â”‚   Contains:                             Contains:                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”€â”€â”€â”€â”€â”€â”€â”€â”€                            â”‚
â”‚   â€¢ Node.js (180MB)                     â€¢ Nginx (25MB)                       â”‚
â”‚   â€¢ node_modules (500MB)                â€¢ dist/ files (2MB)                  â”‚
â”‚   â€¢ Source code (10MB)                  â€¢ NO Node.js!                        â”‚
â”‚   â€¢ dist/ files (2MB)                   â€¢ NO source code!                    â”‚
â”‚                                         â€¢ NO node_modules!                   â”‚
â”‚                                                                              â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                              â”‚
â”‚   SAVINGS: 700MB â†’ 30MB = 95% reduction! ğŸ‰                                  â”‚
â”‚                                                                              â”‚
â”‚   BENEFITS:                                                                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                                 â”‚
â”‚   â€¢ âš¡ Faster deployments (less data to download - 30MB vs 700MB!)          â”‚
â”‚   â€¢ ğŸ’° Lower cloud storage costs (70% less storage!)                        â”‚
â”‚   â€¢ ğŸ”’ No source code in production (security!)                             â”‚
â”‚   â€¢ ğŸ›¡ï¸ Smaller attack surface (less tools = less vulnerabilities!)          â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. AS Keyword - Stage Naming

```dockerfile
FROM node:20-alpine AS builder
                    â†‘
                    Stage name (nee choice!)
```

### 6.1 Stage Names Examples

```dockerfile
# Valid stage names:
FROM node:20-alpine AS builder
FROM node:20-alpine AS build-stage
FROM node:20-alpine AS compile
FROM node:20-alpine AS stage1

# Later reference:
COPY --from=builder ...
COPY --from=build-stage ...
```

---

## 7. Interview Answers (40LPA+ Level) ğŸ¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                              â”‚
â”‚   Q: "Why multi-stage build?"                                                â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                 â”‚
â”‚   A: "We separate build environment from runtime environment.               â”‚
â”‚       Build stage has Node.js and all dependencies.                         â”‚
â”‚       Runtime stage has only Nginx and built static files.                  â”‚
â”‚       Result: 95% smaller image, no source code exposure."                  â”‚
â”‚                                                                              â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                              â”‚
â”‚   Q: "What are the benefits?"                                                â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                             â”‚
â”‚   A: "1. Dramatic size reduction (700MB â†’ 30MB)                             â”‚
â”‚       2. Faster CI/CD pipelines                                              â”‚
â”‚       3. No source code in production (security!)                           â”‚
â”‚       4. Reduced attack surface                                              â”‚
â”‚       5. Lower cloud costs"                                                  â”‚
â”‚                                                                              â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚
â”‚                                                                              â”‚
â”‚   Q: "When to use multi-stage?"                                              â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                           â”‚
â”‚   A: "Any compiled or bundled application:                                  â”‚
â”‚       â€¢ React/Angular/Vue (npm build â†’ static files)                        â”‚
â”‚       â€¢ Go (compile â†’ binary)                                                â”‚
â”‚       â€¢ Java/Spring Boot (mvn package â†’ JAR)                                â”‚
â”‚       Not needed for Python if dependencies are lightweight."               â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Summary

| Stage | Purpose | Final Image lo Undha? |
|-------|---------|----------------------|
| Stage 1 (builder) | Compile/Build | âŒ THROWN AWAY! |
| Stage 2 (final) | Serve/Run | âœ… THIS IS SAVED! |

---

## ğŸ‘‰ Next: [04-layer-caching.md](./04-layer-caching.md) - Build time optimize cheyyadam nerchukondham
